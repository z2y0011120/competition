import{i as r,_ as w,d as B,o as E,c as C,b as a,w as l,a as f,e as p}from"./index-789cd201.js";import{E as F}from"./el-dialog-19ea18e4.js";import"./el-overlay-55eb4b45.js";import{E as M,a as S}from"./el-form-item-0fc3dfa5.js";import{E as k}from"./el-pagination-d72db8aa.js";import{E as _}from"./el-input-26b7f203.js";import"./el-tag-4ea04386.js";import"./el-select-bd4a6b65.js";import{E as q,a as z}from"./el-table-column-e16de002.js";import{E as T}from"./el-button-cc310b46.js";import{d as b}from"./dayjs.min-4904ffcd.js";/* empty css                   */import{E as v}from"./index-c9eff66b.js";import{E as u}from"./index-3bbe16be.js";import"./use-form-item-f09bf200.js";import"./_Uint8Array-76672878.js";import"./_initCloneObject-f66fa92e.js";import"./debounce-c87c8148.js";import"./validator-87c37b4d.js";const N=e=>r.request({url:"api/major/page",method:"post",data:e}),$=e=>r.request({url:"api/major/delete",method:"get",params:e}),U=e=>r.request({url:"api/major/edit",method:"post",data:e}),Y=e=>r.request({url:"api/major/one",method:"get",params:e}),H=e=>r.request({url:"api/major/add",method:"post",data:e}),L=e=>r.request({url:"api/major/getMajorForSelectByDepartId",method:"get",params:e}),W=e=>r.request({url:"api/major/getMajorsForSelectBySchoolId",method:"get",params:e}),P=e=>r.request({url:"api/major/getMajorsForSelectByDepart",method:"get",params:e}),A=e=>r.request({url:"api/major/colums",method:"get",params:e}),O=()=>r.request({url:"api/major/all",method:"get"}),i={getMajorByPage:N,deleteById:$,updateById:U,queryById:Y,addOne:H,getall:O,getcolums:A,getMajorsForSelectByDepart:P,getMajorsForSelectBySchoolId:W,getMajorForSelectByDepartld:L};const G=B({data(){return{tableData:[],page:1,serch:{departId:"",departName:"",schoolId:""},total:0,limit:10,major:{},dialogFormVisible:!1}},methods:{fetchData(e){console.log(e),this.page=e;const t={current:e,size:this.limit};i.getMajorByPage(t).then(s=>{console.log(s);const g=s.data.page;this.tableData=g.records,this.tableData.forEach(h=>{h.createTime=b(h.createTime).format("YYYY-MM-DD HH:mm:ss"),h.updateTime=b(h.createTime).format("YYYY-MM-DD HH:mm:ss"),console.log(h.createTime)}),this.total=g.total})},handleDelete(e){const t={id:e};v.confirm("你确定删除该行数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{i.deleteById(t).then(s=>{console.log(s),s.success?(u({type:"success",message:"删除成功"}),this.fetchData(1)):u({type:"error",message:"删除失败"})})}).catch(()=>{u({type:"warning",message:"取消删除"})})},handleEdit(e){this.dialogFormVisible=!0;const t={id:e};i.queryById(t).then(s=>{this.major=s.data.major})},toAdd(){this.major={},this.dialogFormVisible=!0},excute(){this.major.id!=null?(i.updateById(this.major).then(e=>{e.success?(u({type:"success",message:"编辑成功"}),this.fetchData(1)):u({type:"error",message:"编辑失败"})}),this.dialogFormVisible=!1):i.addOne(this.major).then(e=>{e.success?(u({type:"success",message:"添加成功"}),this.fetchData(1)):u({type:"error",message:"添加失败"}),this.dialogFormVisible=!1})},changeSize(e){this.limit=e,this.fetchData(this.page)},selectById(){if(this.serch.departId){const e={departId:this.serch.departId};i.getMajorForSelectByDepartld(e).then(t=>{this.tableData=t.data.majors})}else if(this.serch.departName){const e={depart:this.serch.departName};i.getMajorsForSelectByDepart(e).then(t=>{this.tableData=t.data.majors})}else if(this.serch.schoolId){const e={schoolId:this.serch.schoolId};i.getMajorsForSelectBySchoolId(e).then(t=>{console.log(t),this.tableData=t.data.majors})}},reset(){this.serch={},this.fetchData(1)}},mounted(){this.fetchData(1)}}),J={class:""},K={class:"table"},Q={class:"dialog-footer"};function R(e,t,s,g,h,X){const n=T,m=_,d=z,j=q,y=k,c=M,I=S,V=F;return E(),C("div",J,[a(n,{type:"success",size:"small",onClick:e.toAdd},{default:l(()=>[p("添加")]),_:1},8,["onClick"]),a(m,{modelValue:e.serch.departId,"onUpdate:modelValue":t[0]||(t[0]=o=>e.serch.departId=o),placeholder:"请输入学院ID",clearable:"",style:{width:"120px"}},null,8,["modelValue"]),a(m,{modelValue:e.serch.departName,"onUpdate:modelValue":t[1]||(t[1]=o=>e.serch.departName=o),placeholder:"请输入学院名称",clearable:"",style:{width:"120px"}},null,8,["modelValue"]),a(m,{modelValue:e.serch.schoolId,"onUpdate:modelValue":t[2]||(t[2]=o=>e.serch.schoolId=o),placeholder:"请输入学校ID",clearable:"",style:{width:"120px"}},null,8,["modelValue"]),a(n,{type:"primary",onClick:e.selectById},{default:l(()=>[p("搜索")]),_:1},8,["onClick"]),a(n,{type:"info",onClick:e.reset},{default:l(()=>[p("重置")]),_:1},8,["onClick"]),f("div",K,[a(j,{data:e.tableData,style:{width:"100%"}},{default:l(()=>[a(d,{fixed:"",prop:"id",label:"编号",width:"150",align:"center"}),a(d,{prop:"majorName",label:"专业名称",width:"210",align:"center"}),a(d,{prop:"majorDesc",label:"专业描述",width:"120",align:"center"}),a(d,{prop:"departId",label:"学院编号",width:"120",align:"center"}),a(d,{prop:"schoolId",label:"学校编号",width:"120",align:"center"}),a(d,{prop:"createTime",label:"创建时间",width:"250",align:"center"}),a(d,{prop:"updateTime",label:"更新时间",width:"250",align:"center"}),a(d,{fixed:"right",label:"操作",width:"180",align:"center"},{default:l(o=>[a(n,{size:"small",onClick:D=>e.handleEdit(o.row.id)},{default:l(()=>[p("编辑")]),_:2},1032,["onClick"]),a(n,{size:"small",type:"danger",onClick:D=>e.handleDelete(o.row.id)},{default:l(()=>[p("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),a(y,{"current-page":e.page,total:e.total,"page-size":e.limit,"page-sizes":[5,10,20,30,40,50,100],style:{padding:"30px 0","text-align":"center"},layout:"sizes, prev, pager, next, jumper, ->, total, slot",onCurrentChange:e.fetchData,onSizeChange:e.changeSize},null,8,["current-page","total","page-size","onCurrentChange","onSizeChange"]),a(V,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":t[9]||(t[9]=o=>e.dialogFormVisible=o),title:"添加/编辑"},{footer:l(()=>[f("span",Q,[a(n,{onClick:t[7]||(t[7]=o=>e.dialogFormVisible=!1)},{default:l(()=>[p("取消")]),_:1}),a(n,{type:"primary",onClick:t[8]||(t[8]=o=>e.excute())},{default:l(()=>[p(" 确定 ")]),_:1})])]),default:l(()=>[a(I,{model:e.major},{default:l(()=>[a(c,{label:"专业名称","label-width":e.formLabelWidth},{default:l(()=>[a(m,{modelValue:e.major.majorName,"onUpdate:modelValue":t[3]||(t[3]=o=>e.major.majorName=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(c,{label:"专业描述","label-width":e.formLabelWidth},{default:l(()=>[a(m,{modelValue:e.major.majorDesc,"onUpdate:modelValue":t[4]||(t[4]=o=>e.major.majorDesc=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(c,{label:"学校编号","label-width":e.formLabelWidth},{default:l(()=>[a(m,{modelValue:e.major.schoolId,"onUpdate:modelValue":t[5]||(t[5]=o=>e.major.schoolId=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),a(c,{label:"学院编号","label-width":e.formLabelWidth},{default:l(()=>[a(m,{modelValue:e.major.departId,"onUpdate:modelValue":t[6]||(t[6]=o=>e.major.departId=o),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const be=w(G,[["render",R],["__scopeId","data-v-b1d0c3b2"]]);export{be as default};
