import{i as h,ab as S,C as p,K as q,o as P,c as A,h as V,v as _,a as f,b as l,w as o,M as N,e as v}from"./index-789cd201.js";import{E as K}from"./el-dialog-19ea18e4.js";import"./el-overlay-55eb4b45.js";import{E as G,a as J}from"./el-form-item-0fc3dfa5.js";import{E as Q}from"./el-input-26b7f203.js";import{E as R}from"./el-pagination-d72db8aa.js";import"./el-tag-4ea04386.js";import"./el-select-bd4a6b65.js";import{E as X,a as Z}from"./el-table-column-e16de002.js";import{E as ee}from"./el-button-cc310b46.js";import{d as j}from"./dayjs.min-4904ffcd.js";import"./use-form-item-f09bf200.js";import"./_Uint8Array-76672878.js";import"./_initCloneObject-f66fa92e.js";import"./debounce-c87c8148.js";import"./validator-87c37b4d.js";function le(r){return h({url:"api/mobile/elogin",method:"post",data:r})}function te(){return h({url:"api/student/all",method:"get"})}function ae(r){return h({url:`/api/student/one?id=${r}`,method:"get"})}function oe(r){return h({url:`/api/student/delete?id=${r}`,method:"get"})}function de(r){return h({url:"/api/student/add",method:"post",data:r})}function ne(r){return h({url:"/api/student/edit",method:"post",data:r})}const ue={class:"aaa"},ie=f("div",{style:{"margin-left":"30px","margin-top":"30px","font-size":"20px"}},"学生信息管理",-1),se=f("br",null,null,-1),re=f("br",null,null,-1),me={class:"dialog-footer"},pe={class:"dialog-footer"},Le={__name:"student",setup(r){const D=S(),b=p(!1),g=p(!1),w=p(!1),W=p({email:"116964635@qq.com",password:"12345678"});q(()=>{});const C=p([]),n=p({createTime:"",depart:"",id:0,major:"",school:"",studentName:"",studentNo:"",updateTime:"",classinfo:""});let T=p(10),y=p(1);const d=p({});let E=p(2);const k=()=>{let a=W.value;le(a).then(e=>{if(e.code==1){let u=e.data.userinfo.token;E.value=e.data.userinfo.id,D.setToken(u),b.value=!0,c()}else alert("登录失败，请检查账号或密码输入是否有误。")})},$=()=>{let a={createTime:new Date,depart:n.value.depart,id:0,major:n.value.major,school:n.value.school,studentName:n.value.studentName,studentNo:n.value.studentNo,classinfo:n.value.classinfo,updateTime:new Date,userId:E.value};de(a).then(e=>{e.code==1&&(alert("添加学生信息成功！"),c())})},z=a=>{ae(a).then(e=>{let u=e.data.student;d.value=u})},Y=()=>{if(confirm("是否要进行更新？"))if(d.value.id=="")alert("请选择要操作的学生信息。");else{let a={createTime:d.value.createTime,depart:d.value.depart,id:d.value.id,major:d.value.major,school:d.value.school,studentName:d.value.studentName,studentNo:d.value.studentNo,classinfo:d.value.classinfo,updateTime:new Date,userId:E.value};ne(a).then(e=>{e.code==1&&(alert("更新成功。"),M(),setTimeout(()=>{c()},1e3))})}},M=()=>{d.value={createTime:"",depart:"",id:0,major:"",school:"",studentName:"",studentNo:"",updateTime:"",classinfo:""}},O=a=>{confirm("是否要删除该学生信息？")&&oe(a).then(e=>{e.code==1&&(alert("成功删除学生信息！"),c())})};function F(a){y=a,c()}function I(a){T=a,c()}function c(){te().then(a=>{a.success?(console.log(a),C.value=a.data.students.filter(e=>e.school==="泉州信息工程学院"),C.value.forEach(e=>{e.createTime=j(e.createTime).format("YYYY年MM月DD日 HH:mm:ss"),e.updateTime=j(e.updateTime).format("YYYY年MM月DD日 HH:mm:ss")})):alert("数据过多，请求失败，请重新刷新")})}return(a,e)=>{const u=ee,m=Z,x=X,B=R,i=Q,s=G,U=J,L=K;return P(),A("div",null,[V(f("div",ue,[V(l(u,{type:"primary",color:"",onClick:e[0]||(e[0]=t=>k()),style:{"margin-left":"40%","margin-top":"20%","font-size":"20px",height:"80px",width:"180px"}},{default:o(()=>[v("获取最新学生信息")]),_:1},512),[[_,b.value==!1]])],512),[[_,b.value==!1]]),V(f("div",null,[ie,V(l(u,{type:"success",color:"",onClick:e[1]||(e[1]=t=>g.value=!0),style:{"margin-left":"89%",width:"80px"}},{default:o(()=>[v("添加")]),_:1},512),[[_,b.value]])],512),[[_,b.value]]),se,V(f("div",null,[f("div",null,[l(x,{data:C.value.slice((N(y)-1)*N(T),N(y)*N(T)),border:"",style:{width:"100%","margin-left":"20px"}},{default:o(()=>[l(m,{fixed:"",prop:"id",label:"id",width:"60",align:"center"}),l(m,{prop:"school",label:"学校",width:"160",align:"center"}),l(m,{prop:"depart",label:"所属学院",width:"90",align:"center"}),l(m,{prop:"major",label:"专业",width:"90",align:"center"}),l(m,{prop:"classinfo",label:"班级",width:"120",align:"center"}),l(m,{prop:"studentNo",label:"学号",width:"110",align:"center"}),l(m,{prop:"studentName",label:"学生姓名",width:"80",align:"center"}),l(m,{prop:"createTime",label:"创建时间",width:"140",align:"center"}),l(m,{prop:"updateTime",label:"更新时间",width:"140",align:"center"}),l(m,{fixed:"right",label:"操作",width:"160",align:"center"},{default:o(t=>[l(u,{type:"primary",color:"",onClick:H=>(w.value=!0,z(t.row.id))},{default:o(()=>[v("更新")]),_:2},1032,["onClick"]),l(u,{type:"danger",color:"",onClick:H=>O(t.row.id)},{default:o(()=>[v("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(B,{background:"",layout:"prev, pager, next, sizes, total, jumper","page-sizes":[5,10,15,20],"page-size":N(T),total:C.value.length,onCurrentChange:F,onSizeChange:I},null,8,["page-size","total"])]),re],512),[[_,b.value]]),l(L,{modelValue:g.value,"onUpdate:modelValue":e[10]||(e[10]=t=>g.value=t),title:"添加/更改"},{footer:o(()=>[f("span",me,[l(u,{onClick:e[8]||(e[8]=t=>g.value=!1)},{default:o(()=>[v("Cancel")]),_:1}),l(u,{type:"primary",onClick:e[9]||(e[9]=t=>(g.value=!1,$()))},{default:o(()=>[v(" 保存 ")]),_:1})])]),default:o(()=>[l(U,{model:n.value},{default:o(()=>[l(s,{label:"学校","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:n.value.school,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.school=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"所属学院","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:n.value.depart,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.depart=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"专业","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:n.value.major,"onUpdate:modelValue":e[4]||(e[4]=t=>n.value.major=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"班级","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:n.value.classinfo,"onUpdate:modelValue":e[5]||(e[5]=t=>n.value.classinfo=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"学号","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:n.value.studentNo,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value.studentNo=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"学生姓名","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:n.value.studentName,"onUpdate:modelValue":e[7]||(e[7]=t=>n.value.studentName=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(L,{modelValue:w.value,"onUpdate:modelValue":e[19]||(e[19]=t=>w.value=t),title:"添加/更改"},{footer:o(()=>[f("span",pe,[l(u,{onClick:e[17]||(e[17]=t=>w.value=!1)},{default:o(()=>[v("Cancel")]),_:1}),l(u,{type:"primary",onClick:e[18]||(e[18]=t=>(w.value=!1,Y()))},{default:o(()=>[v(" 保存 ")]),_:1})])]),default:o(()=>[l(U,{model:n.value},{default:o(()=>[l(s,{label:"学校","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:d.value.school,"onUpdate:modelValue":e[11]||(e[11]=t=>d.value.school=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"所属学院","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:d.value.depart,"onUpdate:modelValue":e[12]||(e[12]=t=>d.value.depart=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"专业","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:d.value.major,"onUpdate:modelValue":e[13]||(e[13]=t=>d.value.major=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"班级","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:d.value.classinfo,"onUpdate:modelValue":e[14]||(e[14]=t=>d.value.classinfo=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"学号","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:d.value.studentNo,"onUpdate:modelValue":e[15]||(e[15]=t=>d.value.studentNo=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(s,{label:"学生姓名","label-width":a.formLabelWidth},{default:o(()=>[l(i,{modelValue:d.value.studentName,"onUpdate:modelValue":e[16]||(e[16]=t=>d.value.studentName=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{Le as default};
