import{i as p,_ as C,d as I,o as _,c as B,b as l,w as o,a as g,e as d}from"./index-789cd201.js";import{E as k}from"./el-dialog-19ea18e4.js";import"./el-overlay-55eb4b45.js";import{E as F,a as z}from"./el-form-item-0fc3dfa5.js";import{E as T}from"./el-pagination-d72db8aa.js";import{E as v}from"./el-input-26b7f203.js";import"./el-tag-4ea04386.js";import"./el-select-bd4a6b65.js";import{E as N,a as q}from"./el-table-column-e16de002.js";import{E as S}from"./el-button-cc310b46.js";import{d as b}from"./dayjs.min-4904ffcd.js";/* empty css                   */import{E as Y}from"./index-c9eff66b.js";import{E as m}from"./index-3bbe16be.js";import"./use-form-item-f09bf200.js";import"./_Uint8Array-76672878.js";import"./_initCloneObject-f66fa92e.js";import"./debounce-c87c8148.js";import"./validator-87c37b4d.js";const $=e=>p.request({url:"api/role/page",method:"post",data:e}),M=e=>p.request({url:"api/role/delete",method:"get",params:e}),U=e=>p.request({url:"api/role/edit",method:"post",data:e}),H=e=>p.request({url:"api/role/one",method:"get",params:e}),L=e=>p.request({url:"api/role/add",method:"post",data:e}),P=()=>p.request({url:"api/role/all",method:"get"}),r={getmenuruleByPage:$,deleteById:M,updateById:U,queryById:H,addOne:L,getall:P};const W=I({data(){return{tableData:[],page:1,serch:{departId:"",departName:"",schoolId:""},total:0,limit:10,menurule:{},dialogFormVisible:!1}},methods:{fetchData(e){console.log(e),this.page=e;const t={current:e,size:this.limit};r.getmenuruleByPage(t).then(s=>{console.log(s);const h=s.data.page;this.tableData=h.records,this.tableData.forEach(u=>{u.createTime=b(u.createTime).format("YYYY-MM-DD HH:mm:ss"),u.updateTime=b(u.createTime).format("YYYY-MM-DD HH:mm:ss"),console.log(u.createTime)}),this.total=h.total})},handleDelete(e){const t={id:e};Y.confirm("你确定删除该行数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.deleteById(t).then(s=>{console.log(s),s.success?(m({type:"success",message:"删除成功"}),this.fetchData(1)):m({type:"error",message:"删除失败"})})}).catch(()=>{m({type:"warning",message:"取消删除"})})},handleEdit(e){this.dialogFormVisible=!0;const t={id:e};r.queryById(t).then(s=>{this.menurule=s.data.role})},toAdd(){this.menurule={},this.dialogFormVisible=!0},excute(){this.menurule.id!=null?(r.updateById(this.menurule).then(e=>{e.success?(m({type:"success",message:"编辑成功"}),this.fetchData(1)):m({type:"error",message:"编辑失败"})}),this.dialogFormVisible=!1):r.addOne(this.menurule).then(e=>{e.success?(m({type:"success",message:"添加成功"}),this.fetchData(1)):m({type:"error",message:"添加失败"}),this.dialogFormVisible=!1})},changeSize(e){this.limit=e,this.fetchData(this.page)},selectById(){if(this.serch.departId){const e={departId:this.serch.departId};r.getmenuruleForSelectByDepartld(e).then(t=>{this.tableData=t.data.menurules})}else if(this.serch.roleName){const e={depart:this.serch.roleName};r.getmenurulesForSelectByDepart(e).then(t=>{console.log(t.data.menurules),this.tableData=t.data.menurules})}else if(this.serch.schoolId){const e={schoolId:this.serch.schoolId};r.getmenurulesForSelectBySchoolId(e).then(t=>{console.log(t),this.tableData=t.data.menurules})}},reset(){this.serch={},this.fetchData(1)}},mounted(){this.fetchData(1)}}),j={class:""},A={class:"table"},O={class:"dialog-footer"};function R(e,t,s,h,u,G){const n=S,c=v,i=q,y=N,V=T,f=F,D=z,w=k;return _(),B("div",j,[l(n,{type:"success",size:"small",onClick:e.toAdd},{default:o(()=>[d("添加")]),_:1},8,["onClick"]),l(c,{modelValue:e.serch.roleName,"onUpdate:modelValue":t[0]||(t[0]=a=>e.serch.roleName=a),placeholder:"请输入角色名称",clearable:"",style:{width:"120px"}},null,8,["modelValue"]),l(c,{modelValue:e.serch.description,"onUpdate:modelValue":t[1]||(t[1]=a=>e.serch.description=a),placeholder:"请输入描述",clearable:"",style:{width:"120px"}},null,8,["modelValue"]),l(n,{type:"primary",onClick:e.selectById},{default:o(()=>[d("搜索")]),_:1},8,["onClick"]),l(n,{type:"info",onClick:e.reset},{default:o(()=>[d("重置")]),_:1},8,["onClick"]),g("div",A,[l(y,{data:e.tableData,style:{width:"100%"}},{default:o(()=>[l(i,{fixed:"",prop:"id",label:"编号",width:"150",align:"center"}),l(i,{prop:"roleName",label:"角色名称",width:"210",align:"center"}),l(i,{prop:"description",label:"描述",width:"120",align:"center"}),l(i,{prop:"status",label:"状态",width:"120",align:"center"}),l(i,{prop:"createTime",label:"创建时间",width:"250",align:"center"}),l(i,{prop:"updateTime",label:"更新时间",width:"250",align:"center"}),l(i,{fixed:"right",label:"操作",width:"180",align:"center"},{default:o(a=>[l(n,{size:"small",onClick:E=>e.handleEdit(a.row.id)},{default:o(()=>[d("编辑")]),_:2},1032,["onClick"]),l(n,{size:"small",type:"danger",onClick:E=>e.handleDelete(a.row.id)},{default:o(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),l(V,{"current-page":e.page,total:e.total,"page-size":e.limit,"page-sizes":[5,10,20,30,40,50,100],style:{padding:"30px 0","text-align":"center"},layout:"sizes, prev, pager, next, jumper, ->, total, slot",onCurrentChange:e.fetchData,onSizeChange:e.changeSize},null,8,["current-page","total","page-size","onCurrentChange","onSizeChange"]),l(w,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":t[7]||(t[7]=a=>e.dialogFormVisible=a),title:"添加/编辑"},{footer:o(()=>[g("span",O,[l(n,{onClick:t[5]||(t[5]=a=>e.dialogFormVisible=!1)},{default:o(()=>[d("取消")]),_:1}),l(n,{type:"primary",onClick:t[6]||(t[6]=a=>e.excute())},{default:o(()=>[d(" 确定 ")]),_:1})])]),default:o(()=>[l(D,{model:e.menurule},{default:o(()=>[l(f,{label:"角色名称","label-width":e.formLabelWidth},{default:o(()=>[l(c,{modelValue:e.menurule.roleName,"onUpdate:modelValue":t[2]||(t[2]=a=>e.menurule.roleName=a),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(f,{label:"描述","label-width":e.formLabelWidth},{default:o(()=>[l(c,{modelValue:e.menurule.description,"onUpdate:modelValue":t[3]||(t[3]=a=>e.menurule.description=a),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(f,{label:"状态","label-width":e.formLabelWidth},{default:o(()=>[l(c,{modelValue:e.menurule.status,"onUpdate:modelValue":t[4]||(t[4]=a=>e.menurule.status=a),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])])}const ce=C(W,[["render",R],["__scopeId","data-v-899f3855"]]);export{ce as default};
